<!DOCTYPE html>
<html lang="zh-CN">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">
    <title>æ–°æ˜¥å‰¯ä¸šå¼€é—¨çº¢</title>
    <!-- Tailwind CSS -->
    <script src="https://cdn.tailwindcss.com"></script>
    <!-- React & ReactDOM -->
    <script src="https://unpkg.com/react@18/umd/react.production.min.js" crossorigin></script>
    <script src="https://unpkg.com/react-dom@18/umd/react-dom.production.min.js" crossorigin></script>
    <!-- Babel for JSX -->
    <script src="https://unpkg.com/@babel/standalone/babel.min.js"></script>
    
    <style>
        /* Custom Animations & Styles */
        body {
            background-color: #E60012;
            font-family: -apple-system, BlinkMacSystemFont, "Segoe UI", Roboto, "Helvetica Neue", Arial, "Noto Sans", sans-serif;
        }

        .perspective-1000 { perspective: 1000px; }
        .transform-style-3d { transform-style: preserve-3d; }
        .backface-hidden { backface-visibility: hidden; }
        .rotate-y-180 { transform: rotateY(180deg); }
        
        @keyframes shuffle1 { 
            0% { transform: translateX(0) rotateY(180deg); } 
            50% { transform: translateX(100%) rotateY(180deg); } 
            100% { transform: translateX(0) rotateY(180deg); } 
        }
        @keyframes shuffle2 { 
            0% { transform: translateX(0) rotateY(180deg); } 
            50% { transform: translateX(-100%) rotateY(180deg); } 
            100% { transform: translateX(0) rotateY(180deg); } 
        }
        
        .shuffle-move-1 { animation: shuffle1 0.5s ease-in-out infinite; }
        .shuffle-move-2 { animation: shuffle2 0.5s ease-in-out infinite alternate; }

        @keyframes popup-bounce {
            0% { transform: scale(0.5); opacity: 0; }
            60% { transform: scale(1.1); opacity: 1; }
            100% { transform: scale(1); opacity: 1; }
        }
        .animate-popup { animation: popup-bounce 0.5s cubic-bezier(0.175, 0.885, 0.32, 1.275) forwards; }

        .bg-pattern {
            background-color: #E60012;
            background-image: url("data:image/svg+xml,%3Csvg width='60' height='60' viewBox='0 0 60 60' xmlns='http://www.w3.org/2000/svg'%3E%3Cg fill='none' fill-rule='evenodd'%3E%3Cg fill='%239e0000' fill-opacity='0.2'%3E%3Cpath d='M36 34v-4h-2v4h-4v2h4v4h2v-4h4v-2h-4zm0-30V0h-2v4h-4v2h4v4h2V6h4V4h-4zM6 34v-4H4v4H0v2h4v4h2v-4h4v-2H6zM6 4V0H4v4H0v2h4v4h2V6h4V4H6z'/%3E%3C/g%3E%3C/g%3E%3C/svg%3E");
        }

        /* Hide Scrollbar */
        .no-scrollbar::-webkit-scrollbar {
            display: none;
        }
        .no-scrollbar {
            -ms-overflow-style: none;
            scrollbar-width: none;
        }
    </style>
</head>
<body>
    <div id="root"></div>

    <script type="text/babel">
        const { useState, useEffect, useRef } = React;

        // --- Icons (SVG Components) ---
        const IconBase = ({ children, size = 24, className = "" }) => (
            <svg xmlns="http://www.w3.org/2000/svg" width={size} height={size} viewBox="0 0 24 24" fill="none" stroke="currentColor" strokeWidth="2" strokeLinecap="round" strokeLinejoin="round" className={className}>
                {children}
            </svg>
        );

        const Trophy = (props) => <IconBase {...props}><path d="M6 9H4.5a2.5 2.5 0 0 1 0-5H6"/><path d="M18 9h1.5a2.5 2.5 0 0 0 0-5H18"/><path d="M4 22h16"/><path d="M10 14.66V17c0 .55-.47.98-.97 1.21C7.85 18.75 7 20.24 7 22"/><path d="M14 14.66V17c0 .55.47.98.97 1.21C16.15 18.75 17 20.24 17 22"/><path d="M18 2H6v7a6 6 0 0 0 12 0V2Z"/></IconBase>;
        const Gift = (props) => <IconBase {...props}><rect x="3" y="8" width="18" height="4" rx="1"/><path d="M12 8v13"/><path d="M19 12v7a2 2 0 0 1-2 2H7a2 2 0 0 1-2-2v-7"/><path d="M7.5 8a2.5 2.5 0 0 1 0-5A4.8 8 0 0 1 12 8a4.8 8 0 0 1 4.5-5 2.5 2.5 0 0 1 0 5"/></IconBase>;
        const TrendingUp = (props) => <IconBase {...props}><polyline points="23 6 13.5 15.5 8.5 10.5 1 18"/><polyline points="17 6 23 6 23 12"/></IconBase>;
        const Users = (props) => <IconBase {...props}><path d="M16 21v-2a4 4 0 0 0-4-4H6a4 4 0 0 0-4 4v2"/><circle cx="9" cy="7" r="4"/><path d="M22 21v-2a4 4 0 0 0-3-3.87"/><path d="M16 3.13a4 4 0 0 1 0 7.75"/></IconBase>;
        const ChevronRight = (props) => <IconBase {...props}><path d="m9 18 6-6-6-6"/></IconBase>;
        const Share2 = (props) => <IconBase {...props}><circle cx="18" cy="5" r="3"/><circle cx="6" cy="12" r="3"/><circle cx="18" cy="19" r="3"/><line x1="8.59" x2="15.42" y1="13.51" y2="17.49"/><line x1="15.41" x2="8.59" y1="6.51" y2="10.49"/></IconBase>;
        const Wallet = (props) => <IconBase {...props}><path d="M21 12V7H5a2 2 0 0 1 0-4h14v4"/><path d="M3 5v14a2 2 0 0 0 2 2h16v-5"/><path d="M18 12a2 2 0 0 0 0 4h4v-4Z"/></IconBase>;
        const MapPin = (props) => <IconBase {...props}><path d="M20 10c0 6-8 12-8 12s-8-6-8-12a8 8 0 0 1 16 0Z"/><circle cx="12" cy="10" r="3"/></IconBase>;
        const Star = (props) => <IconBase {...props}><polygon points="12 2 15.09 8.26 22 9.27 17 14.14 18.18 21.02 12 17.77 5.82 21.02 7 14.14 2 9.27 8.91 8.26 12 2"/></IconBase>;
        const CheckCircle2 = (props) => <IconBase {...props}><circle cx="12" cy="12" r="10"/><path d="m9 12 2 2 4-4"/></IconBase>;
        const X = (props) => <IconBase {...props}><path d="M18 6 6 18"/><path d="m6 6 12 12"/></IconBase>;
        const Smartphone = (props) => <IconBase {...props}><rect width="14" height="20" x="5" y="2" rx="2" ry="2"/><path d="M12 18h.01"/></IconBase>;
        const Shuffle = (props) => <IconBase {...props}><path d="M2 18h1.4c1.3 0 2.5-.6 3.3-1.7l14.2-12.6c.8-1 2-1.7 3.3-1.7H22"/><path d="M2 5h1.6c1.3 0 2.5.7 3.3 1.7l14.2 12.6c.8 1 2 1.7 3.3 1.7H22"/></IconBase>;
        const Target = (props) => <IconBase {...props}><circle cx="12" cy="12" r="10"/><circle cx="12" cy="12" r="6"/><circle cx="12" cy="12" r="2"/></IconBase>;
        const ThumbsUp = (props) => <IconBase {...props}><path d="M7 10v12"/><path d="M15 5.88 14 10h5.83a2 2 0 0 1 1.92 2.56l-2.33 8A2 2 0 0 1 17.5 22H4a2 2 0 0 1-2-2v-8a2 2 0 0 1 2-2h2.76a2 2 0 0 0 1.79-1.11L12 2h0a3.13 3.13 0 0 1 3 3.88Z"/></IconBase>;
        const Volume2 = (props) => <IconBase {...props}><polygon points="11 5 6 9 2 9 2 15 6 15 11 19 11 5"/><path d="M15.54 8.46a5 5 0 0 1 0 7.07"/><path d="M19.07 4.93a10 10 0 0 1 0 14.14"/></IconBase>;
        const Download = (props) => <IconBase {...props}><path d="M21 15v4a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2v-4"/><polyline points="7 10 12 15 17 10"/><line x1="12" x2="12" y1="15" y2="3"/></IconBase>;

        // --- Mock Data ---
        const LEADERBOARD_DATA = [
            { id: 1, name: "å¼ å¸ˆå‚…", area: "æœé˜³åŒº", score: 1250, reward: 1888, recommended: 45, avatar: "ğŸ¦" },
            { id: 2, name: "æé˜¿å§¨", area: "æµ·æ·€åŒº", score: 1180, reward: 1288, recommended: 40, avatar: "ğŸ¯" },
            { id: 3, name: "ç‹å°å“¥", area: "è¥¿åŸåŒº", score: 1050, reward: 888, recommended: 38, avatar: "ğŸ‰" },
            { id: 4, name: "èµµå¤§åŠ›", area: "ä¸°å°åŒº", score: 980, reward: 688, recommended: 35, avatar: "ğŸ¼" }, 
            { id: 5, name: "å­™å¿«æ‰‹", area: "é€šå·åŒº", score: 920, reward: 688, recommended: 32, avatar: "ğŸ¦Š" }, 
            { id: 6, name: "å‘¨ç®¡å®¶", area: "å¤§å…´åŒº", score: 890, reward: 688, recommended: 31, avatar: "ğŸ±" }, 
            { id: 7, name: "å´ä¿æ´", area: "æ˜Œå¹³åŒº", score: 850, reward: 388, recommended: 28, avatar: "ğŸ°" }, 
        ];

        const MARQUEE_LIST = [
            "åˆšåˆš æå¸ˆå‚…ç¿»å‡ºç¦æ°”çº¢åŒ… 8.88 å…ƒ",
            "ä»Šå¤© ç‹å¸ˆå‚…æ¥åˆ°äº†ç¬¬10å•é¢†åˆ° 188.8 å…ƒ",
            "åˆšåˆš å´ä¿æ´é«˜æ‰‹æ¦œæ’åä¸Šå‡ 2 å",
            "å–œæŠ¥ èµµå¤§åŠ›æˆåŠŸæç° 50 å…ƒ",
            "åˆšåˆš å­™å¿«æ‰‹å®Œæˆä»Šæ—¥ç¬¬5å•ä»»åŠ¡",
            "ç¥è´º å‘¨ç®¡å®¶é‚€è¯·å¥½å‹è·å¾— 30 ç§¯åˆ†"
        ];

        const App = () => {
            // --- State Management ---
            const [points, setPoints] = useState(650);
            const [rank, setRank] = useState(25);
            const [prevRank, setPrevRank] = useState(28); // For rank up logic
            const [showRankPopup, setShowRankPopup] = useState(false);
            const [scoreGap, setScoreGap] = useState(2); // Initial gap: 2 points
            
            // Sign In State
            const [signInDays, setSignInDays] = useState(2);
            const [isSignedToday, setIsSignedToday] = useState(false);
            const [showSignInPopup, setShowSignInPopup] = useState(false);
            const [signInRewardAmount, setSignInRewardAmount] = useState(0);
            const [pendingRankUp, setPendingRankUp] = useState(false); // Flag to chain popups
            
            // Lucky Draw State
            const [drawPhase, setDrawPhase] = useState('idle'); 
            const [selectedCardIndex, setSelectedCardIndex] = useState(null);
            const [showDrawPopup, setShowDrawPopup] = useState(false); // New: Draw Popup State
            const [cards, setCards] = useState([
                { val: 1.88, id: 1 }, { val: 2.88, id: 2 }, { val: 4.88, id: 3 }, { val: 6.88, id: 4 }, { val: 8.88, id: 5 }
            ]);
            const [drawChance, setDrawChance] = useState(0);
            const [likeProgress, setLikeProgress] = useState(3); 

            // Order Challenge
            const [orderCount, setOrderCount] = useState(2);

            // Marquee State
            const [marqueeIdx, setMarqueeIdx] = useState(0);

            // Share Poster State
            const [showSharePoster, setShowSharePoster] = useState(false);
            
            // Show Off Poster State (New)
            const [showShowOffPoster, setShowShowOffPoster] = useState(false);

            // --- Handlers ---

            // Marquee Timer
            useEffect(() => {
                const interval = setInterval(() => {
                setMarqueeIdx(prev => (prev + 1) % MARQUEE_LIST.length);
                }, 2500); 
                return () => clearInterval(interval);
            }, []);

            // 1. Simulate Rank Up (Clicking Points trigger)
            const handleSimulateRankUp = () => {
                setShowRankPopup(true);
                setPoints(prev => prev + 2);
                setScoreGap(0);
                setRank(prev => Math.max(1, prev - 1));
            };

            // 2. Sign In Handler with Chained Popups
            const handleSignIn = () => {
                if (!isSignedToday) {
                setIsSignedToday(true);
                const newDays = signInDays + 1;
                setSignInDays(newDays);
                setPoints(prev => prev + 2);
                
                // Simulate closing the gap
                setScoreGap(0);

                // Check for milestone reward (Simulated: Day 3 gets 0.88, Day 5 gets 1.88)
                if ([3, 5, 7, 15, 30].includes(newDays)) {
                    let amount = 0;
                    if(newDays === 3) amount = 0.88;
                    else if(newDays === 5) amount = 1.88;
                    else if(newDays === 7) amount = 2.88; 
                    else if(newDays === 15) amount = 6.88; 
                    else amount = 8.88;
                    
                    setSignInRewardAmount(amount);
                    setShowSignInPopup(true);
                    setPendingRankUp(true); // Mark that rank up should show after this closes
                } else {
                    // If no sign in popup, simulate rank up directly
                    setTimeout(() => {
                        setShowRankPopup(true);
                        setRank(prev => Math.max(1, prev - 1));
                    }, 800);
                }
                }
            };

            // Helper to close Sign In Popup and trigger Rank Up if needed
            const closeSignInPopup = () => {
                setShowSignInPopup(false);
                if (pendingRankUp) {
                    setPendingRankUp(false);
                    // Small delay before next popup for better UX
                    setTimeout(() => {
                        setShowRankPopup(true);
                        setRank(prev => Math.max(1, prev - 1)); // Update rank number visually
                    }, 400);
                }
            };

            // 3. Lucky Draw Logic
            const startDraw = () => {
                setDrawPhase('preparing');
                setTimeout(() => {
                    setDrawPhase('shuffling');
                    setTimeout(() => {
                        const shuffled = [...cards].sort(() => Math.random() - 0.5);
                        setCards(shuffled);
                        setDrawPhase('picking');
                    }, 2000);
                }, 600);
            };

            const pickCard = (index) => {
                if (drawPhase !== 'picking') return;
                setSelectedCardIndex(index);
                setDrawPhase('result');
                
                // Show popup after card flip animation
                setTimeout(() => {
                    setShowDrawPopup(true);
                }, 800);
            };

            const resetDraw = () => {
                setDrawPhase('idle');
                setSelectedCardIndex(null);
                setShowDrawPopup(false);
                setCards([ { val: 1.88, id: 1 }, { val: 2.88, id: 2 }, { val: 4.88, id: 3 }, { val: 6.88, id: 4 }, { val: 8.88, id: 5 } ]);
            };

            // 4. Handle Share Click
            const handleShareClick = () => {
                setShowSharePoster(true);
            };

            // 5. Handle Show Off Click (New)
            const handleShowOffClick = () => {
                setShowRankPopup(false);
                setShowShowOffPoster(true);
            };

            return (
                <div className="min-h-screen bg-pattern font-sans text-gray-800 pb-20 relative overflow-x-hidden w-full max-w-md mx-auto shadow-2xl">
                
                {/* --- 1. Header KV --- */}
                <header className="relative h-64 overflow-hidden text-center text-white pt-10">
                    <div className="absolute top-0 left-0 w-full h-full bg-gradient-to-b from-red-800 to-transparent z-0"></div>
                    <div className="absolute top-0 left-4 w-12 h-16 bg-red-700 rounded-b-xl border-t-4 border-yellow-500 shadow-lg animate-pulse z-10 flex items-center justify-center">
                    <span className="text-yellow-400 font-serif text-xl border-2 border-yellow-600 rounded-full p-1">ç¦</span>
                    <div className="absolute -bottom-4 left-1/2 w-1 h-4 bg-yellow-500 -translate-x-1/2"></div>
                    </div>
                    <div className="absolute top-0 right-4 w-12 h-16 bg-red-700 rounded-b-xl border-t-4 border-yellow-500 shadow-lg animate-pulse z-10 flex items-center justify-center" style={{animationDelay: '1s'}}>
                    <span className="text-yellow-400 font-serif text-xl border-2 border-yellow-600 rounded-full p-1">æ˜¥</span>
                    <div className="absolute -bottom-4 left-1/2 w-1 h-4 bg-yellow-500 -translate-x-1/2"></div>
                    </div>
                    <div className="relative z-20 mt-4">
                    <h1 className="text-4xl font-extrabold text-transparent bg-clip-text bg-gradient-to-b from-yellow-300 to-yellow-600 drop-shadow-md stroke-red-800 tracking-wider">
                        æå‰¯ä¸š<br/>æ‹¿çº¢åŒ…<br/>è¿‡å¥½å¹´
                    </h1>
                    <div className="inline-block mt-3 bg-red-900 px-4 py-1 rounded-full border border-yellow-500 shadow-lg">
                        <span className="text-sm font-bold text-yellow-100">å‹‡æ•¢è¸ä¸€æ­¥ï¼Œå‰¯ä¸šæœ‰å‡ºè·¯</span>
                    </div>
                    </div>
                </header>

                {/* --- 2. Dashboard --- */}
                <section className="relative z-30 px-4 -mt-6">
                    <div className="bg-white rounded-2xl shadow-xl overflow-hidden border border-red-100">
                        <div 
                            className="bg-gradient-to-r from-orange-50 via-yellow-50 to-white px-4 py-3 flex items-center justify-between border-b border-orange-100 cursor-pointer active:bg-orange-100 transition-colors"
                            onClick={handleSimulateRankUp}
                        >
                            <div className="flex items-center gap-2">
                                <div className="w-5 h-5 rounded-full bg-red-100 border border-red-200 flex items-center justify-center text-red-600 shadow-sm">
                                    <Target size={12} />
                                </div>
                                <span className="text-xs text-red-800 font-medium">
                                    åŠ æ²¹ï¼è·ç¦»ä¸Šä¸€åã€é«˜æ‰‹ã€‘è¿˜å·® <span className="text-base font-black text-red-600 mx-0.5">{scoreGap}</span> ç§¯åˆ†
                                </span>
                            </div>
                            <div className="w-10 h-1.5 bg-gray-200 rounded-full overflow-hidden flex-shrink-0">
                                <div className="h-full bg-red-500 rounded-full animate-pulse" style={{width: scoreGap === 0 ? '100%' : '70%'}}></div>
                            </div>
                        </div>

                        <div className="p-4 grid grid-cols-4 gap-2 text-center relative z-10">
                            <div className="flex flex-col items-center justify-center cursor-pointer active:scale-95 transition" onClick={handleSimulateRankUp}>
                                <span className="text-red-600 font-black text-xl">{points}</span>
                                <span className="text-gray-500 text-xs mt-1">å½“å‰ç§¯åˆ†</span>
                            </div>
                            <div className="flex flex-col items-center justify-center">
                                <span className="text-red-600 font-bold text-lg">12</span>
                                <span className="text-gray-500 text-xs mt-1">è¢«æ¨è</span>
                            </div>
                            <div className="flex flex-col items-center justify-center">
                                <span className="text-red-600 font-bold text-lg">Â¥128</span>
                                <span className="text-gray-500 text-xs mt-1">ç´¯è®¡ç°é‡‘</span>
                            </div>
                            <div className="flex flex-col items-center justify-center cursor-pointer" onClick={() => document.getElementById('leaderboard').scrollIntoView({behavior: 'smooth'})}>
                                <div className="text-red-600 font-bold text-lg">No.{rank}</div>
                                <span className="text-gray-500 text-xs mt-1">å½“å‰æ’å</span>
                            </div>
                        </div>
                        
                        {/* Marquee Section */}
                        <div className="h-px w-full bg-red-100"></div>
                        <div className="px-4 py-2.5 bg-red-50 flex items-center gap-2">
                            <div className="bg-red-200 p-1 rounded-full shadow-sm"><Volume2 size={12} className="text-red-700"/></div>
                            <div className="flex-1 h-5 relative overflow-hidden">
                                <div 
                                    className="absolute top-0 left-0 w-full transition-transform duration-500 ease-in-out flex flex-col items-start"
                                    style={{ transform: `translateY(-${marqueeIdx * 20}px)` }}
                                >
                                    {MARQUEE_LIST.map((text, i) => (
                                        <div key={i} className="h-5 flex items-center text-xs text-red-800 font-medium whitespace-nowrap">
                                            {text}
                                        </div>
                                    ))}
                                </div>
                            </div>
                        </div>
                    </div>
                </section>

                {/* --- 3. Gameplay Modules --- */}
                <div className="px-4 mt-6 space-y-6">

                    {/* Module 1: Sign In */}
                    <div className="bg-[#FFF8E7] rounded-xl overflow-hidden shadow-md border border-red-200">
                        <div className="bg-red-800 text-yellow-100 px-4 py-2 flex justify-between items-center">
                            <div>
                                <h3 className="font-bold text-lg">ã€æ–°æ˜¥å¼€å·¥ç­¾ã€‘</h3>
                                <p className="text-xs text-yellow-300 opacity-90">å¥½è¿å¤©å¤©æ·»ï¼Œè¿ç­¾æ‹¿å¤§å¥–</p>
                            </div>
                            <div className="bg-yellow-500 text-red-900 text-xs font-bold px-2 py-1 rounded">å·²è¿ç»­{signInDays}å¤©</div>
                        </div>
                        <div className="p-4">
                            <div className="flex justify-between items-start mb-4 mt-2">
                                {[1, 2, 3, 4, 5, 6, 7].map((day) => {
                                    const isPast = day <= signInDays;
                                    const isMilestone = [3, 5, 7, 15, 30].includes(day);
                                    const milestoneAmounts = {3: 0.88, 5: 1.88, 7: 2.88, 15: 6.88, 30: 8.88};
                                    
                                    return (
                                        <div key={day} className={`flex flex-col items-center w-10 ${isPast ? 'opacity-100' : 'opacity-60'}`}>
                                            <div className={`w-9 h-9 rounded-full flex items-center justify-center border-2 mb-1 relative
                                                ${isPast 
                                                    ? 'bg-yellow-100 border-yellow-500' 
                                                    : 'bg-white border-red-100'
                                                }
                                            `}>
                                                {isMilestone ? (
                                                    <div className="relative">
                                                        <Gift size={18} className="text-red-600" />
                                                    </div>
                                                ) : (
                                                    <div className="flex flex-col items-center justify-center leading-none">
                                                        <div className="w-2.5 h-2.5 rounded-full bg-yellow-400 border border-yellow-600 mb-0.5"></div>
                                                        <span className="text-[9px] font-bold text-red-800">+2</span>
                                                    </div>
                                                )}
                                                
                                                {isPast && (
                                                    <div className="absolute -right-1 -bottom-1 bg-green-500 rounded-full p-0.5 border border-white">
                                                        <CheckCircle2 size={8} className="text-white"/>
                                                    </div>
                                                )}
                                            </div>
                                            <span className="text-xs text-gray-600 mb-0.5 font-medium">ç¬¬{day}å¤©</span>
                                            {isMilestone ? (
                                                <span className="text-[9px] font-bold text-red-600 bg-red-50 px-1 rounded border border-red-100 leading-tight">Â¥{milestoneAmounts[day]}</span>
                                            ) : (
                                                <span className="h-3"></span>
                                            )}
                                        </div>
                                    )
                                })}
                            </div>

                            <button 
                                onClick={handleSignIn}
                                disabled={isSignedToday}
                                className={`w-full py-3 rounded-full font-bold text-sm shadow-md transition-all flex items-center justify-center gap-2
                                    ${isSignedToday 
                                        ? 'bg-gray-200 text-gray-400 cursor-not-allowed shadow-none' 
                                        : 'bg-gradient-to-r from-red-600 to-red-500 text-white active:scale-95 border-2 border-red-400'
                                    }`}
                            >
                                {isSignedToday ? (
                                    <><CheckCircle2 size={16}/> ä»Šæ—¥ç§¯åˆ†å·²+2</>
                                ) : (
                                    <><Smartphone size={16}/> ç‚¹äº®åç‰‡é¢†ç§¯åˆ†</>
                                )}
                            </button>
                            
                            <div className="text-center mt-3 text-xs text-red-800 bg-yellow-50 py-1.5 rounded-lg border border-yellow-100">
                                {(() => {
                                    const milestones = [3, 5, 7, 15, 30];
                                    const nextDay = milestones.find(d => d > signInDays) || 30;
                                    const amounts = {3: 0.88, 5: 1.88, 7: 2.88, 15: 6.88, 30: 8.88};
                                    const gap = nextDay - signInDays;
                                    
                                    return (
                                        <span>
                                            å·²è¿ç»­ç­¾åˆ° <strong>{signInDays}</strong> å¤©ï¼Œå†ç­¾ <strong>{gap}</strong> å¤©å¿…å¾— <strong>{amounts[nextDay]}</strong> å…ƒçº¢åŒ…ï¼
                                        </span>
                                    );
                                })()}
                            </div>
                        </div>
                    </div>

                    {/* Module 2: Lucky Draw */}
                    <div className="bg-[#FFF8E7] rounded-xl shadow-md border border-red-200 relative">
                        <div className="bg-red-800 text-yellow-100 px-4 py-2 flex justify-between items-center rounded-t-xl">
                            <div>
                                <h3 className="font-bold text-lg">ã€ç¦æ°”ç¿»ç¿»ä¹ã€‘</h3>
                                <p className="text-xs text-yellow-300 opacity-90">æƒŠå–œè—ä¸ä½ï¼Œæ‰‹æ°”åšå¤´å½©</p>
                            </div>
                            <div className="bg-yellow-500 text-red-900 text-xs font-bold px-2 py-1 rounded">ç¿»æ‰‹æ°”å‰©ä½™1æ¬¡</div>
                        </div>
                        
                        <div className="p-4 bg-[url('https://www.transparenttextures.com/patterns/cubes.png')] rounded-b-xl">
                            <div className="bg-red-100 text-red-600 text-xs px-2 py-1 rounded mb-3 text-center truncate">
                                æœ¬æœŸå¥–æ± ï¼š1.88å…ƒ | 2.88å…ƒ | 4.88å…ƒ | 6.88å…ƒ | 8.88å…ƒ
                            </div>

                            <div className="h-32 flex justify-between items-center relative perspective-1000 mb-4">
                                {cards.map((card, idx) => {
                                    const isBackVisible = drawPhase === 'preparing' || drawPhase === 'shuffling' || drawPhase === 'picking';
                                    return (
                                        <div 
                                            key={card.id}
                                            onClick={() => pickCard(idx)}
                                            className={`
                                                w-[18%] h-24 absolute transition-all duration-700 transform-style-3d cursor-pointer
                                                ${drawPhase === 'shuffling' && idx % 2 === 0 ? 'shuffle-move-1' : ''}
                                                ${drawPhase === 'shuffling' && idx % 2 !== 0 ? 'shuffle-move-2' : ''}
                                            `}
                                            style={{ 
                                                left: `${idx * 20 + 2}%`,
                                                transform: isBackVisible ? 'rotateY(180deg)' : 'rotateY(0deg)'
                                            }}
                                        >
                                            <div className="absolute w-full h-full bg-gradient-to-b from-yellow-100 to-yellow-300 border-2 border-yellow-500 rounded-lg flex flex-col items-center justify-center backface-hidden shadow-lg">
                                                <span className="text-xs text-red-800 font-bold mb-1">çº¢åŒ…</span>
                                                <span className={`font-black text-red-600 ${drawPhase === 'result' && selectedCardIndex !== idx ? 'opacity-50' : 'scale-110'}`}>
                                                    {card.val}
                                                </span>
                                            </div>
                                            <div className="absolute w-full h-full bg-gradient-to-br from-red-600 to-red-800 border-2 border-yellow-500 rounded-lg flex items-center justify-center backface-hidden rotate-y-180 shadow-lg">
                                                <div className="w-8 h-8 border-2 border-yellow-400 rounded-full flex items-center justify-center text-yellow-400 font-serif text-sm">ç¦</div>
                                            </div>
                                        </div>
                                    )
                                })}
                            </div>

                            {/* Status Text (Only show if shuffling/picking) */}
                            {(drawPhase === 'shuffling' || drawPhase === 'picking' || drawPhase === 'preparing') && (
                                <div className="text-center mb-2">
                                    <div className="text-red-800 font-bold animate-pulse">
                                        {drawPhase === 'picking' ? 'è¯·å‡­ç›´è§‰é€‰ä¸€å¼ ï¼' : 'æ´—ç‰Œä¸­...'}
                                    </div>
                                </div>
                            )}

                            <div className="mt-4 pt-2 mb-8">
                                <div className="flex justify-between items-center mb-2">
                                    <span className="text-xs text-gray-600">ä»Šæ—¥ç¦æ°”è¿›åº¦</span>
                                    <span className="text-xs font-bold text-red-600">æ¨èæ•°{likeProgress}/5</span>
                                </div>
                                
                                <div className="relative w-full h-8 mb-2">
                                    <div className="absolute top-1/2 left-0 w-full h-2 bg-red-100 rounded-full -translate-y-1/2"></div>
                                    <div className="absolute top-1/2 left-0 h-2 bg-red-600 rounded-full -translate-y-1/2 transition-all duration-500" style={{width: `${(likeProgress/5)*100}%`}}></div>
                                    
                                    <div className="absolute top-1/2 left-[40%] -translate-x-1/2 -translate-y-1/2 flex flex-col items-center">
                                        <div className={`w-5 h-5 rounded-full border-2 flex items-center justify-center text-[10px] font-bold z-10 ${likeProgress >= 2 ? 'bg-red-600 border-yellow-200 text-yellow-100 shadow-sm' : 'bg-white border-red-200 text-gray-400'}`}>2</div>
                                        <div className="absolute -bottom-8 bg-yellow-100 border border-yellow-400 text-red-600 text-[10px] font-bold px-1.5 py-0.5 rounded shadow-sm whitespace-nowrap z-20">
                                            æŠ½1æ¬¡
                                            <div className="absolute -top-1 left-1/2 -translate-x-1/2 w-2 h-2 bg-yellow-100 border-t border-l border-yellow-400 transform rotate-45"></div>
                                        </div>
                                    </div>

                                    <div className="absolute top-1/2 left-[100%] -translate-x-1/2 -translate-y-1/2 flex flex-col items-center">
                                        <div className={`w-5 h-5 rounded-full border-2 flex items-center justify-center text-[10px] font-bold z-10 ${likeProgress >= 5 ? 'bg-red-600 border-yellow-200 text-yellow-100 shadow-sm' : 'bg-white border-red-200 text-gray-400'}`}>5</div>
                                        <div className="absolute -bottom-8 bg-yellow-100 border border-yellow-400 text-red-600 text-[10px] font-bold px-1.5 py-0.5 rounded shadow-sm whitespace-nowrap z-20">
                                            å†æŠ½1æ¬¡
                                            <div className="absolute -top-1 left-1/2 -translate-x-1/2 w-2 h-2 bg-yellow-100 border-t border-l border-yellow-400 transform rotate-45"></div>
                                        </div>
                                    </div>
                                </div>
                            </div>

                            <div className="flex gap-3">
                                {drawPhase === 'idle' ? (
                                    <button onClick={startDraw} className="flex-1 bg-gradient-to-b from-yellow-400 to-yellow-600 text-red-900 py-2.5 rounded-xl font-bold shadow-lg active:scale-95 flex items-center justify-center gap-1">
                                        <Shuffle size={16}/> æ´—ç‰ŒæŠ½å¥–
                                    </button>
                                ) : drawPhase === 'result' ? (
                                    <button onClick={resetDraw} className="flex-1 bg-red-600 text-white py-2.5 rounded-xl font-bold shadow-lg active:scale-95 flex items-center justify-center gap-1">
                                        å†æ¥ä¸€æ¬¡
                                    </button>
                                ) : (
                                    <button disabled className="flex-1 bg-gray-300 text-gray-500 py-2.5 rounded-xl font-bold shadow-none flex items-center justify-center gap-1 cursor-not-allowed">
                                        <Shuffle size={16} className="animate-spin"/> æ¸¸æˆä¸­...
                                    </button>
                                )}
                                <button onClick={handleShareClick} className="flex-1 bg-white border border-red-300 text-red-600 py-2.5 rounded-xl font-bold flex items-center justify-center gap-1 shadow-sm active:bg-red-50">
                                    <Share2 size={16}/> åˆ†äº«æ‹¿ç¦æ°”
                                </button>
                            </div>
                        </div>
                    </div>

                    {/* Module 3: Order Challenge */}
                    <div className="bg-[#FFF8E7] rounded-xl overflow-hidden shadow-md border border-red-200">
                        <div className="bg-red-800 text-yellow-100 px-4 py-2 flex justify-between items-center">
                            <div>
                                <h3 className="font-bold text-lg">ã€æ¥å•è´¢è¿äº¨ã€‘</h3>
                                <p className="text-xs text-yellow-300 opacity-90">æ¥å•èšå®ç›†ï¼Œå¤šåŠ³èµšç°é‡‘</p>
                            </div>
                            <div className="bg-yellow-500 text-red-900 text-xs font-bold px-2 py-1 rounded">è®¢å•è¿›åº¦{orderCount}å•</div>
                        </div>
                        <div className="p-4">
                            <div className="flex items-end justify-between px-2 mb-8 relative">
                                <div className="absolute w-[80%] h-1 bg-red-100 top-5 left-[10%] -z-0">
                                    <div className="h-full bg-red-500 transition-all rounded-full" style={{width: `${(orderCount/10)*100}%`}}></div>
                                </div>
                                {[
                                    {step: 1, val: 18.8, done: orderCount >= 1},
                                    {step: 3, val: 28.8, done: orderCount >= 3},
                                    {step: 5, val: 68.8, done: orderCount >= 5},
                                    {step: 10, val: 188.8, done: orderCount >= 10},
                                ].map((item, idx) => (
                                    <div key={idx} className="flex flex-col items-center gap-2 w-1/4 relative z-10">
                                        <div className={`relative px-2 py-1 rounded-lg border-2 shadow-sm transition-transform duration-300 ${item.done ? 'bg-red-600 border-red-600 text-yellow-100 scale-110 -translate-y-1' : 'bg-white border-red-200 text-red-400'}`}>
                                            <span className="text-[10px] font-bold mr-0.5">Â¥</span>
                                            <span className="text-sm font-black tracking-tighter">{item.val}</span>
                                            <div className={`absolute -bottom-1 left-1/2 -translate-x-1/2 w-2 h-2 rotate-45 border-r-2 border-b-2 ${item.done ? 'bg-red-600 border-red-600' : 'bg-white border-red-200'}`}></div>
                                        </div>
                                        <div className={`w-3 h-3 rounded-full border-2 ${item.done ? 'bg-yellow-400 border-red-500 ring-2 ring-red-200' : 'bg-white border-red-200'}`}></div>
                                        <span className={`text-xs font-bold mt-1 ${item.done ? 'text-red-700' : 'text-gray-400'}`}>å®Œæˆç¬¬{item.step}å•</span>
                                    </div>
                                ))}
                            </div>
                            <div className="bg-red-50 p-2 rounded-lg mb-4">
                                <h4 className="text-xs font-bold text-red-800 mb-1">ğŸ’° ç§¯åˆ†è§„åˆ™ï¼š</h4>
                                <div className="flex flex-wrap gap-1">
                                    <span className="text-[10px] bg-white border border-red-100 px-1 rounded text-gray-600">20-49å…ƒ: +5åˆ†</span>
                                    <span className="text-[10px] bg-white border border-red-100 px-1 rounded text-gray-600">50-99å…ƒ: +10åˆ†</span>
                                    <span className="text-[10px] bg-white border border-red-100 px-1 rounded text-gray-600">100-199å…ƒ: +15åˆ†</span>
                                    <span className="text-[10px] bg-white border border-red-100 px-1 rounded text-gray-600">200-299å…ƒ: +20åˆ†</span>
                                    <span className="text-[10px] bg-white border border-red-100 px-1 rounded text-gray-600">300å…ƒ+: +30åˆ†</span>
                                </div>
                            </div>
                            <button onClick={handleShareClick} className="w-full bg-red-600 text-white font-bold py-3 rounded-xl shadow-lg flex items-center justify-center gap-2 active:bg-red-700">
                                å»æ¥å•èµšé’± <ChevronRight size={16}/>
                            </button>
                        </div>
                    </div>

                </div>

                {/* --- 4. Leaderboard --- */}
                <section id="leaderboard" className="mt-8 px-4 pb-12">
                    <div className="text-center mb-6">
                        <h2 className="text-2xl font-extrabold text-transparent bg-clip-text bg-gradient-to-b from-yellow-300 to-yellow-500 drop-shadow-sm stroke-red-800">ã€é©¬ä¸Šè¿è–ªÂ·ç¤¾åŒºæœåŠ¡é«˜æ‰‹æ¦œã€‘</h2>
                        <p className="text-yellow-100 text-xs mt-1">æœåŠ¡ä¹‹æ˜Ÿ æ¦œä¸Šæœ‰å ç°é‡‘å¤§å¥–ç­‰ä½ æ‹¿</p>
                    </div>
                    <div className="flex justify-center items-end mb-6 gap-2">
                        {/* 2nd Place */}
                        <div className="flex flex-col items-center relative w-1/3">
                            <div className="w-12 h-12 bg-gray-200 rounded-full border-2 border-gray-400 flex items-center justify-center text-xl shadow-lg relative z-10">
                                {LEADERBOARD_DATA[1].avatar}
                                <div className="absolute -bottom-2 bg-gray-500 text-white text-[10px] px-1.5 rounded-full border border-gray-300">No.2</div>
                            </div>
                            <div className="text-white text-xs mt-1 font-bold truncate w-full text-center">{LEADERBOARD_DATA[1].name}</div>
                            <div className="bg-gradient-to-b from-gray-300 to-gray-400 w-full rounded-t-lg mt-2 pt-2 pb-1 flex flex-col items-center justify-end border-t-4 border-gray-200 h-28 relative">
                                {/* Data Card Overlay */}
                                <div className="bg-white/90 rounded-lg p-1 mb-1 w-[90%] flex flex-col items-center justify-center shadow-sm">
                                    <span className="text-[10px] font-bold text-gray-800">{LEADERBOARD_DATA[1].score}åˆ†</span>
                                    <span className="text-[9px] text-gray-600 flex items-center gap-0.5"><ThumbsUp size={8}/> {LEADERBOARD_DATA[1].recommended}</span>
                                </div>
                                <span className="font-black text-gray-800 text-sm mt-1">Â¥{LEADERBOARD_DATA[1].reward}</span>
                            </div>
                        </div>
                        {/* 1st Place */}
                        <div className="flex flex-col items-center z-10 relative w-1/3 -mx-2">
                            <div className="text-yellow-400 mb-1"><Trophy size={24} /></div>
                            <div className="w-16 h-16 bg-yellow-100 rounded-full border-4 border-yellow-500 flex items-center justify-center text-2xl shadow-lg relative z-10">
                                {LEADERBOARD_DATA[0].avatar}
                                <div className="absolute -top-4 right-0 transform rotate-12">ğŸ‘‘</div>
                                <div className="absolute -bottom-2 bg-yellow-600 text-white text-[10px] px-2 rounded-full border border-yellow-300">No.1</div>
                            </div>
                            <div className="text-white text-sm mt-1 font-bold truncate w-full text-center">{LEADERBOARD_DATA[0].name}</div>
                            <div className="bg-gradient-to-b from-yellow-400 to-yellow-600 w-full rounded-t-lg mt-2 pt-2 pb-1 flex flex-col items-center justify-end border-t-4 border-yellow-200 shadow-xl h-36 relative">
                                {/* Data Card Overlay */}
                                <div className="bg-white/90 rounded-lg p-1.5 mb-1 w-[90%] flex flex-col items-center justify-center shadow-sm">
                                    <span className="text-xs font-black text-red-600">{LEADERBOARD_DATA[0].score}åˆ†</span>
                                    <span className="text-[10px] text-gray-600 flex items-center gap-0.5"><ThumbsUp size={10}/> {LEADERBOARD_DATA[0].recommended}</span>
                                </div>
                                <span className="font-black text-red-900 text-lg mt-1">Â¥{LEADERBOARD_DATA[0].reward}</span>
                            </div>
                        </div>
                        {/* 3rd Place */}
                        <div className="flex flex-col items-center relative w-1/3">
                            <div className="w-12 h-12 bg-orange-100 rounded-full border-2 border-orange-400 flex items-center justify-center text-xl shadow-lg relative z-10">
                                {LEADERBOARD_DATA[2].avatar}
                                <div className="absolute -bottom-2 bg-orange-600 text-white text-[10px] px-1.5 rounded-full border border-orange-300">No.3</div>
                            </div>
                            <div className="text-white text-xs mt-1 font-bold truncate w-full text-center">{LEADERBOARD_DATA[2].name}</div>
                            <div className="bg-gradient-to-b from-orange-300 to-orange-500 w-full rounded-t-lg mt-2 pt-2 pb-1 flex flex-col items-center justify-end border-t-4 border-orange-200 h-24 relative">
                                {/* Data Card Overlay */}
                                <div className="bg-white/90 rounded-lg p-1 mb-1 w-[90%] flex flex-col items-center justify-center shadow-sm">
                                    <span className="text-[10px] font-bold text-orange-800">{LEADERBOARD_DATA[2].score}åˆ†</span>
                                    <span className="text-[9px] text-gray-600 flex items-center gap-0.5"><ThumbsUp size={8}/> {LEADERBOARD_DATA[2].recommended}</span>
                                </div>
                                <span className="font-bold text-orange-900 text-sm mt-1">Â¥{LEADERBOARD_DATA[2].reward}</span>
                            </div>
                        </div>
                    </div>
                    <div className="bg-white rounded-xl overflow-hidden shadow-lg">
                        <div className="bg-red-50 px-4 py-2 text-xs text-red-500 flex items-center gap-1 border-b border-red-100">
                            <TrendingUp size={12}/> âš ï¸ å†²æ¦œå¿…è¯»ï¼šå‰10åéœ€ç§¯åˆ†&gt;800ï¼Œè¢«æ¨èæ•°&gt;30
                        </div>
                        {LEADERBOARD_DATA.slice(3).map((user, idx) => (
                            <div key={user.id} className="flex items-center justify-between p-3 border-b border-gray-100 last:border-0">
                                <div className="flex items-center gap-3">
                                    <span className="text-gray-400 font-bold w-4 text-center">{user.id}</span>
                                    <div className="w-8 h-8 bg-gray-100 rounded-full flex items-center justify-center">{user.avatar}</div>
                                    <div>
                                        <div className="text-sm font-bold text-gray-800">{user.name}</div>
                                        <div className="text-[10px] text-gray-500 flex items-center gap-1"><MapPin size={10}/> {user.area}</div>
                                    </div>
                                </div>
                                <div className="flex gap-4 items-center">
                                    <div className="text-center">
                                        <div className="text-xs font-bold text-gray-700 flex items-center gap-0.5 justify-end">
                                            <ThumbsUp size={10} className="text-yellow-500"/> {user.recommended}
                                        </div>
                                        <div className="text-[9px] text-gray-400">æ¨è</div>
                                    </div>
                                    <div className="text-right">
                                        <div className="text-red-600 font-bold text-sm">{user.score}åˆ†</div>
                                        <div className="text-[10px] text-gray-400">å¾…é¢†Â¥{user.reward}</div>
                                    </div>
                                </div>
                            </div>
                        ))}
                        <div className="p-3 text-center text-xs text-gray-400">æŸ¥çœ‹å‰100å &gt;</div>
                    </div>
                </section>

                {/* --- 5. Sticky Footer --- */}
                <div className="fixed bottom-0 left-0 w-full bg-white border-t border-gray-200 shadow-[0_-4px_6px_-1px_rgba(0,0,0,0.1)] p-2 px-4 flex items-center justify-between z-50 max-w-md mx-auto right-0">
                    <div className="flex items-center gap-2">
                        <div className="w-10 h-10 rounded-full bg-gray-100 border-2 border-yellow-400 overflow-hidden shadow-sm">
                            <img src="https://api.dicebear.com/7.x/avataaars/svg?seed=Felix" alt="avatar" className="w-full h-full" />
                        </div>
                        <div className="flex flex-col">
                            <span className="text-[10px] text-gray-500">æˆ‘çš„æ’å</span>
                            <span className="text-sm font-bold text-red-600">No.{rank}</span>
                        </div>
                    </div>
                    <div className="flex-1 ml-4">
                        <button onClick={handleShareClick} className="w-full bg-red-600 text-white px-5 py-2 rounded-lg text-sm font-bold shadow-md animate-pulse flex items-center justify-center gap-2">
                            <Share2 size={16}/> åˆ†äº«èµšåˆ†
                        </button>
                    </div>
                </div>

                {/* --- Share Poster Modal --- */}
                {showSharePoster && (
                    <div className="fixed inset-0 z-[80] flex flex-col items-center justify-center bg-black/80 p-6" onClick={() => setShowSharePoster(false)}>
                        <div className="bg-white w-full max-w-sm rounded-2xl overflow-hidden shadow-2xl relative" onClick={e => e.stopPropagation()}>
                            {/* Header / Red Bg */}
                            <div className="bg-gradient-to-b from-red-600 to-red-700 p-6 pt-8 text-center text-white relative overflow-hidden">
                                {/* Decorative Circles */}
                                <div className="absolute top-0 left-0 w-20 h-20 bg-yellow-400/20 rounded-full -translate-x-1/2 -translate-y-1/2"></div>
                                <div className="absolute top-0 right-0 w-32 h-32 bg-yellow-400/10 rounded-full translate-x-1/3 -translate-y-1/3"></div>
                                
                                <div className="flex flex-col items-center relative z-10">
                                    <div className="w-16 h-16 rounded-full border-2 border-yellow-300 p-0.5 bg-white mb-2 shadow-md">
                                        <img src="https://api.dicebear.com/7.x/avataaars/svg?seed=Felix" alt="avatar" className="w-full h-full rounded-full" />
                                    </div>
                                    <h3 className="font-bold text-xl">å¼ å¸ˆå‚…</h3>
                                    <p className="text-xs opacity-90 flex items-center gap-1 mt-1 bg-black/20 px-2 py-0.5 rounded-full">
                                        <MapPin size={10} /> æœé˜³åŒº Â· é˜³å…‰ç¤¾åŒº
                                    </p>
                                    
                                    <div className="mt-4 text-sm font-medium text-yellow-100 italic leading-relaxed px-4">
                                        â€œé‡‘é©¬è¿æ˜¥å¼€å·¥å‰ï¼Œå‰¯ä¸šæ¥å•å‹¤èµšé’±ã€‚<br/>æ‚¨çš„æ”¯æŒæ˜¯æˆ‘æœ€å¤§çš„åŠ¨åŠ›ï¼Œ<br/>ç¥æ‚¨æ–°çš„ä¸€å¹´ä¸‡äº‹å¦‚æ„ï¼â€
                                    </div>
                                </div>
                            </div>

                            {/* Service Card */}
                            <div className="p-5 bg-white">
                                <div className="bg-yellow-50 border border-yellow-200 rounded-xl p-4 flex items-center justify-between mb-6 shadow-sm">
                                    <div>
                                        <div className="text-gray-500 text-xs mb-1">æ¨èæœåŠ¡</div>
                                        <div className="font-bold text-gray-800 text-lg">ä¸“ä¸šå®¶åº­ä¿æ´</div>
                                    </div>
                                    <div className="text-right">
                                        <div className="text-red-600 font-black text-xl">
                                            <span className="text-xs font-normal text-gray-500 mr-0.5">æ–°æ˜¥ç‰¹æƒ </span>
                                            Â¥128<span className="text-xs">èµ·</span>
                                        </div>
                                    </div>
                                </div>

                                {/* QR Code Area */}
                                <div className="flex items-center justify-center gap-4">
                                    <div className="bg-white p-2 border-2 border-dashed border-gray-300 rounded-lg">
                                        {/* Simulated QR Code (Placeholder) */}
                                        <div className="w-20 h-20 bg-gray-900 flex items-center justify-center text-white text-[8px] font-mono text-center leading-tight">
                                            [äºŒç»´ç ]<br/>æ¨¡æ‹ŸåŒºåŸŸ
                                        </div>
                                    </div>
                                    <div className="text-left">
                                        <p className="font-bold text-gray-800 text-sm">é•¿æŒ‰è¯†åˆ«äºŒç»´ç </p>
                                        <p className="text-xs text-gray-500 mt-0.5">ä¸ºæˆ‘ç‚¹èµ åŠ©åŠ›å¼€å·¥</p>
                                    </div>
                                </div>
                            </div>
                            
                            {/* Save Button */}
                            <div className="bg-gray-50 p-3 text-center border-t border-gray-100">
                                <button className="text-red-600 font-bold text-sm flex items-center justify-center gap-1 mx-auto">
                                    <Download size={14}/> ä¿å­˜æµ·æŠ¥åˆ†äº«
                                </button>
                            </div>
                        </div>
                        <button onClick={() => setShowSharePoster(false)} className="mt-6 bg-white/20 p-2 rounded-full border border-white/50 text-white backdrop-blur-sm hover:bg-white/30 transition-colors">
                            <X size={24}/>
                        </button>
                    </div>
                )}

                {/* --- Show Off Poster Modal (New) --- */}
                {showShowOffPoster && (
                    <div className="fixed inset-0 z-[80] flex flex-col items-center justify-center bg-black/80 p-6" onClick={() => setShowShowOffPoster(false)}>
                        <div className="bg-white w-full max-w-sm rounded-2xl overflow-hidden shadow-2xl relative" onClick={e => e.stopPropagation()}>
                            {/* Header / Red Bg */}
                            <div className="bg-gradient-to-b from-red-600 to-red-800 p-6 pt-10 text-center text-white relative overflow-hidden">
                                {/* Decorative Rays */}
                                <div className="absolute top-1/2 left-1/2 -translate-x-1/2 -translate-y-1/2 w-[200%] h-[200%] bg-[radial-gradient(circle,rgba(255,255,0,0.2)_0%,transparent_60%)] animate-pulse"></div>
                                <div className="absolute top-0 right-0 w-32 h-32 bg-yellow-400/10 rounded-full translate-x-1/3 -translate-y-1/3"></div>
                                
                                <div className="flex flex-col items-center relative z-10">
                                    <div className="w-20 h-20 rounded-full border-4 border-yellow-400 p-0.5 bg-white mb-3 shadow-lg">
                                        <img src="https://api.dicebear.com/7.x/avataaars/svg?seed=Felix" alt="avatar" className="w-full h-full rounded-full" />
                                    </div>
                                    <h3 className="font-bold text-2xl mb-1">å¼ å¸ˆå‚…</h3>
                                    <p className="text-sm opacity-90">æˆ‘åœ¨ <span className="font-bold text-yellow-300">å¦é—¨é›†ç¾åŒº</span> åšæœåŠ¡é«˜æ‰‹</p>
                                </div>
                            </div>

                            {/* Main Content */}
                            <div className="p-6 bg-white text-center relative">
                                <div className="absolute top-0 left-1/2 -translate-x-1/2 -translate-y-1/2 w-4 h-4 bg-white rotate-45"></div>
                                
                                <p className="text-gray-500 text-xs mb-1">ç°åœ¨æ˜¯ä¸Šä¸Šå‰é‚»å·¥å­£</p>
                                <div className="text-red-600 font-black text-4xl mb-4 drop-shadow-sm">ç¬¬15å</div>
                                
                                <div className="bg-red-50 rounded-xl p-4 mb-6 border border-red-100">
                                    <p className="text-gray-800 font-bold mb-1">æˆ‘æƒ³æŒ‘æˆ˜æ‹¿</p>
                                    <div className="text-3xl font-black text-red-600 mb-1">1888<span className="text-sm font-bold">å…ƒ</span> <span className="text-lg text-gray-800">å¤§å¥–</span></div>
                                </div>

                                <div className="text-lg font-bold text-gray-800 mb-6 flex items-center justify-center gap-2">
                                    <span className="text-2xl">ğŸ’ª</span> æˆ‘çš„å‰¯ä¸šå°±å·®ä½ çš„æ”¯æŒ
                                </div>

                                {/* QR Code Area */}
                                <div className="flex flex-col items-center justify-center gap-2">
                                    <div className="bg-white p-2 border-2 border-dashed border-gray-300 rounded-lg">
                                        <div className="w-24 h-24 bg-gray-900 flex items-center justify-center text-white text-[10px] font-mono text-center leading-tight">
                                            [äºŒç»´ç ]<br/>åŠ©åŠ›æ”¯æŒ
                                        </div>
                                    </div>
                                    <p className="text-xs text-gray-400">é•¿æŒ‰è¯†åˆ«äºŒç»´ç ä¸ºæˆ‘åŠ©åŠ›</p>
                                </div>
                            </div>
                            
                            {/* Save Button */}
                            <div className="bg-gray-50 p-3 text-center border-t border-gray-100">
                                <button className="text-red-600 font-bold text-sm flex items-center justify-center gap-1 mx-auto">
                                    <Download size={14}/> ä¿å­˜æµ·æŠ¥åˆ†äº«
                                </button>
                            </div>
                        </div>
                        <button onClick={() => setShowShowOffPoster(false)} className="mt-6 bg-white/20 p-2 rounded-full border border-white/50 text-white backdrop-blur-sm hover:bg-white/30 transition-colors">
                            <X size={24}/>
                        </button>
                    </div>
                )}

                {/* --- Sign In Reward Popup --- */}
                {showSignInPopup && (
                    <div className="fixed inset-0 z-[70] flex flex-col items-center justify-center bg-black/80 px-4">
                        <div className="relative animate-popup w-full max-w-xs flex flex-col items-center">
                            {/* Rays */}
                            <div className="absolute top-1/2 left-1/2 -translate-x-1/2 -translate-y-1/2 w-64 h-64 bg-gradient-radial from-yellow-300 to-transparent opacity-50 blur-xl animate-pulse"></div>
                            
                            <div className="bg-red-600 w-full rounded-xl border-4 border-yellow-400 shadow-2xl relative overflow-hidden text-center pt-8 pb-12 px-4 z-10">
                                {/* Removed top-right close button */}
                                <div className="absolute -top-10 -left-10 w-24 h-24 bg-red-700 rounded-full"></div>
                                <div className="absolute -top-10 -right-10 w-24 h-24 bg-red-700 rounded-full"></div>
                                <h3 className="text-yellow-200 font-bold text-lg mb-2 tracking-widest">å¼€å·¥å¤§å‰</h3>
                                <div className="text-white text-sm mb-4">è¿ç»­ç­¾åˆ°å¥–åŠ±</div>
                                <div className="relative inline-block mb-4">
                                    <span className="text-5xl font-black text-yellow-300 drop-shadow-md">{signInRewardAmount}</span>
                                    <span className="text-yellow-200 text-xl font-bold ml-1">å…ƒ</span>
                                </div>
                                <button onClick={closeSignInPopup} className="w-full bg-yellow-400 text-red-800 font-bold py-2 rounded-full shadow-lg active:scale-95 transition-transform">
                                    å¼€å¿ƒæ”¶ä¸‹
                                </button>
                            </div>
                            <button onClick={closeSignInPopup} className="mt-6 bg-white/20 p-2 rounded-full border border-white/50 text-white backdrop-blur-sm hover:bg-white/30 transition-colors z-10">
                                <X size={24}/>
                            </button>
                        </div>
                    </div>
                )}

                {/* --- Draw Result Popup (New) --- */}
                {showDrawPopup && (
                    <div className="fixed inset-0 z-[70] flex flex-col items-center justify-center bg-black/80 px-4">
                        <div className="relative animate-popup w-full max-w-xs flex flex-col items-center">
                            <div className="absolute top-1/2 left-1/2 -translate-x-1/2 -translate-y-1/2 w-64 h-64 bg-gradient-radial from-yellow-300 to-transparent opacity-50 blur-xl animate-pulse"></div>
                            <div className="bg-red-600 w-full rounded-xl border-4 border-yellow-400 shadow-2xl relative overflow-hidden text-center pt-8 pb-12 px-4 z-10">
                                {/* Removed top-right close button */}
                                <div className="absolute -top-10 -left-10 w-24 h-24 bg-red-700 rounded-full"></div>
                                <div className="absolute -top-10 -right-10 w-24 h-24 bg-red-700 rounded-full"></div>
                                <h3 className="text-yellow-200 font-bold text-lg mb-2 tracking-widest">æ‰‹æ°”ç‚¸è£‚</h3>
                                <div className="text-white text-sm mb-4">æ­å–œæŠ½ä¸­çº¢åŒ…</div>
                                <div className="relative inline-block mb-4">
                                    <span className="text-5xl font-black text-yellow-300 drop-shadow-md">
                                        {selectedCardIndex !== null ? cards[selectedCardIndex].val : '0.00'}
                                    </span>
                                    <span className="text-yellow-200 text-xl font-bold ml-1">å…ƒ</span>
                                </div>
                                <button onClick={() => setShowDrawPopup(false)} className="w-full bg-yellow-400 text-red-800 font-bold py-2 rounded-full shadow-lg active:scale-95 transition-transform">
                                    æ”¾å…¥é’±åŒ…
                                </button>
                            </div>
                            <button onClick={() => setShowDrawPopup(false)} className="mt-6 bg-white/20 p-2 rounded-full border border-white/50 text-white backdrop-blur-sm hover:bg-white/30 transition-colors z-10">
                                <X size={24}/>
                            </button>
                        </div>
                    </div>
                )}

                {/* --- Rank Up Popup (Simulated) --- */}
                {showRankPopup && (
                    <div className="fixed inset-0 z-[60] flex flex-col items-center justify-center bg-black/80 px-4">
                        <div className="relative w-full max-w-sm flex flex-col items-center">
                            <div className="absolute inset-0 overflow-hidden pointer-events-none">
                                {[...Array(20)].map((_, i) => (
                                    <div key={i} className="absolute w-2 h-4 bg-yellow-400 animate-pulse" 
                                        style={{
                                            left: `${Math.random() * 100}%`, 
                                            top: `${Math.random() * 100}%`,
                                            transform: `rotate(${Math.random() * 360}deg)`
                                        }}>
                                    </div>
                                ))}
                            </div>
                            <div className="bg-gradient-to-b from-yellow-100 to-white w-full rounded-2xl p-6 text-center relative shadow-2xl border-4 border-yellow-400 transform scale-100 transition-all z-10">
                                {/* Removed top-right close button */}
                                <div className="text-4xl mb-2">ğŸš€</div>
                                <h2 className="text-2xl font-black text-red-600 mb-2">æ’åé£™å‡!</h2>
                                <p className="text-gray-600 mb-4">
                                    æ­å–œï¼æ‚¨åˆšåˆšè¶…è¶Šäº† <span className="text-red-600 font-bold">3</span> ä½æœåŠ¡è€…<br/>
                                    ç°å±… <span className="text-2xl font-bold text-red-600">No.{rank}</span>
                                </p>
                                <div className="bg-red-50 p-3 rounded-lg border border-red-100 mb-4">
                                    <p className="text-sm text-red-800">
                                        è·ç¦» <strong>388å…ƒ</strong> ç°é‡‘å¤§å¥–<br/>
                                        ä»…å·® <strong>15</strong> ç§¯åˆ†ï¼
                                    </p>
                                </div>
                                <div className="flex gap-3">
                                    <button onClick={handleShowOffClick} className="flex-1 py-2 rounded-full border-2 border-yellow-500 text-yellow-700 font-bold">ç‚«è€€ä¸€ä¸‹</button>
                                    <button className="flex-1 py-2 rounded-full bg-gradient-to-r from-red-500 to-red-700 text-white font-bold shadow-lg" onClick={() => setShowRankPopup(false)}>ç»§ç»­å†²æ¦œ</button>
                                </div>
                            </div>
                            <button onClick={() => setShowRankPopup(false)} className="mt-6 bg-white/20 p-2 rounded-full border border-white/50 text-white backdrop-blur-sm hover:bg-white/30 transition-colors z-10">
                                <X size={24}/>
                            </button>
                        </div>
                    </div>
                )}

                </div>
            );
        };

        ReactDOM.render(<App />, document.getElementById('root'));
    </script>
</body>
</html>
